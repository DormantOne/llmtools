<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LLMTools</title>
</head>
<body>
    <h1>LLMTools Result</h1>
    <hr>
    <div id="result"></div>

    <script>
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        function isPrime(num) {
            if (num <= 1) return false;
            for (let i = 2; i <= Math.sqrt(num); i++) {
                if (num % i === 0) return false;
            }
            return true;
        }

        function findNextPrime(start) {
            let num = parseInt(start) + 1;
            while (!isPrime(num)) num++;
            return num;
        }

        // New: Factorial with BigInt for large numbers
        function factorial(n) {
            n = BigInt(n);
            let result = 1n;
            for (let i = 2n; i <= n; i++) {
                result *= i;
            }
            return result.toString(); // Convert to string for output
        }

        const adderPayload = getQueryParam('adder');
        const primePayload = getQueryParam('prime');
        const factorialPayload = getQueryParam('factorial');

        let result = 'No tool specified. Try ?adder=1+2 or ?prime=10 or ?factorial=5';

        if (adderPayload) {
            try {
                // Safe eval for basic math (limit to + - * /)
                const safeExpr = adderPayload.replace(/[^0-9+\-*/(). ]/g, '');
                result = `Adder result: ${eval(safeExpr)}`;
            } catch (e) {
                result = 'Invalid adder expression.';
            }
        } else if (primePayload) {
            const num = parseInt(primePayload);
            if (!isNaN(num)) {
                result = `Next prime after ${num}: ${findNextPrime(num)}`;
            } else {
                result = 'Invalid prime input.';
            }
        } else if (factorialPayload) {
            const num = parseInt(factorialPayload);
            if (!isNaN(num) && num >= 0 && num <= 1000) { // Cap to avoid browser freeze
                result = `Factorial of ${num}: ${factorial(num)}`;
            } else {
                result = 'Invalid factorial input (use 0-1000).';
            }
        }

        document.getElementById('result').innerText = result;
    </script>
</body>
</html>
